# 보조기억장치
- [보조기억장치](#보조기억장치)
  - [7-1. 다양한 보조기억장치](#7-1-다양한-보조기억장치)
    - [하드디스크](#하드디스크)
      - [하드 디스크의 구성](#하드-디스크의-구성)
      - [플래터 저장 방식](#플래터-저장-방식)
      - [데이터 접근 과정](#데이터-접근-과정)
      - [프로그래머가 꼭 알아야 할 컴퓨터 시간들](#프로그래머가-꼭-알아야-할-컴퓨터-시간들)
      - [다중 헤드 디시크와 고정 헤드 디스크](#다중-헤드-디시크와-고정-헤드-디스크)
    - [플래시 메모리](#플래시-메모리)
      - [두 종류의 플래시 메모리](#두-종류의-플래시-메모리)
      - [플래시 메모리 구성](#플래시-메모리-구성)
      - [셀의 타입](#셀의-타입)
      - [플래시 메모리도 수명 존재](#플래시-메모리도-수명-존재)
      - [플래시 메모리의 동작 방식](#플래시-메모리의-동작-방식)
  - [7-2. RAID의 정의와 종류](#7-2-raid의-정의와-종류)
    - [RAID의 정의](#raid의-정의)
    - [RAID의 종류](#raid의-종류)
    - [RAID 0](#raid-0)
    - [RAID 1](#raid-1)
    - [RAID 4](#raid-4)
    - [RAID 5](#raid-5)
    - [RAID 6](#raid-6)
  - [Q\&A](#qa)
    - [Q1. 하드디스크의 구성 요소와 저장 방식에 대해 설명해주세요.](#q1-하드디스크의-구성-요소와-저장-방식에-대해-설명해주세요)
    - [Q2. 플래시 메모리의 구성 요소와 저장 방식에 대해 설명해주세요.](#q2-플래시-메모리의-구성-요소와-저장-방식에-대해-설명해주세요)
    - [Q3. RAID의 정의와 대표적인 각 종류에 대해 설명해주세요.](#q3-raid의-정의와-대표적인-각-종류에-대해-설명해주세요)

## 7-1. 다양한 보조기억장치
- 보조기억장치
  1. 하드디스크
  2. 플래시 메모리(SD 카드, SSD)

### 하드디스크
- 하드 디스크는 자기적인 방식으로 데이터를 저장하는 보조기억장치
- 자기 디스크(magnetic disk)의 일종으로 지칭하기도 함
- 대용량 저장 장치가 필요한 작업이나 서비실에 자주 출입하는 작업에서 자주 접함
- CD나 LP와 비슷하게 생겼고 실제로도 비슷하게 동작함 
  - 동그란 원판에 데이터를 저장하고 그것을 회전시켜 뽀족한 리더기로 데이터를 읽음

<br>

#### 하드 디스크의 구성     
1. 플래터(Platter) : 동그란 원판
   - 자기 물질로 덮여있어 수많은 N극과 S극을 저장함
   - N극과 S극은 0과 1의 역할을 수행
2. 스핀들(Spindle) : 플래터를 회전시키는 구성 요소
   - RPM (Revolution Per Minute) : 스핀들이 플래터를 분당 회전시키는 속도
3. 헤드 : 플래터를 대상으로 데이터를 읽고 쓰는 구성 요소
   - 플래터 위에서 미세하게 떠 있는 채로 데이터를 읽고 쓰는 바늘 같은 부품
4. 디스크 암 : 원하는 위치로 헤드를 이동시킴, 헤드가 부착되어있음

#### 플래터 저장 방식
- 트랙과 섹터라는 단위로 데이터 저장
  - 트랙 : 플래터를 여러 동심원으로 나누었을 때 하나의 원을 트랙으로 부름 
    - 플래터를 동심원으로 나눈 공간 
  - 섹터 : 플래터를 여러 조각으로 나누었을 때 한 조각
    - 하드 디스크의 가장 작은 전송 단위
    - 일반적으로 512바이트 정도의 크기를 가지고 있음
  - 블록 : 하나 이상의 섹터를 묶어서 부르는 단위

<br>

- 플래터는 여러겹 사용될 수 있음
  - 실린더 : 여러 겁의 플래터 상에 같은 트랙이 위치한 곳을 모아 연결한 논리적 단위
    - 같은 트랙끼리 연결한 원통 모양의 공간

<br>

- 연속된 정보는 보통 한 실린더에 기록됨
  - 두개의 플래터를 사용하는 하드 디스크에서 네 개 섹터에 걸쳐 데이터를 저장할 때 아래와 같이 저장
    - 첫번째 플래터 윗면, 뒷면
    - 두번째 플래터 윗면, 뒷면
    - why? : 디스크 암을 움직이지 않고 데이터에 접근할 수 있기 때문

#### 데이터 접근 과정
- 탐색 시간(seek time) : 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는시간
- 회전 지연(rotational latency) : 헤드가 있는 곳으로 플래터를 회전시키는 시간
- 전송 시간(transfer time) : 하드디스크와 컴퓨터 간에 데이터를 전송하는 시간

#### 프로그래머가 꼭 알아야 할 컴퓨터 시간들
![!\[alt text\](image.png)](<프로그래머가 꼭 알아야 할 컴퓨터 시간들.png>)
- 하드 디스크에서 다량의 데이터를 탐색하고 읽어 들이는 시간은 생각보다 오래 걸림
- 탐색 시간과 회전 지연을 단축시키기 위해서는 플래터를 빨리 돌려 **RPM을 높이는 것**도 중요하지만 접근하려는 데이터가 **플래터 혹은 헤드를 조금만 옮겨도 접근할 수 있는 곳에 위치(참조 지역성)** 해 있는 것도 중요

#### 다중 헤드 디시크와 고정 헤드 디스크
- 단일 헤드 디스크 (이동 헤드 디스크) : 플래터의 한 면당 헤드가 하나씩 달려있는 하드 디스크
- 다중 헤드 디스크 (고정 헤드 디스크) : 헤드가 트랙별로 여러 개 달려 있는 하드 디스크 
  - 탐색 시간이 들지 않음
  - 탐색 시간 = 0

### 플래시 메모리
- 플래시 메모리 : 전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반 저장 장치
- USB 메모리, SD 카드, SSD 모두 플래시 메모리 기반의 보조기억장치
- 다양한 곳에서 널리 사용하는 저장 장치
  - 주기억장치 중 하나인 ROM 등 일상적으로 접하는 모든 전자 제품 안에 내장됨
- 붉은 박스가 플래시 메모리
![!\[alt text\](image.png)](플래시메모리.png)

#### 두 종류의 플래시 메모리
- NAND 플래시 메모리 : NAND 연산을 수행하는 회로를 기반으로 만들어진 메모리
- NOR 플래시 메모리 : NOR 연산을 수행하는 회로를 기반으로 만들어진 메모리
- 별도의 언급이 없는 한 이 책에서 설명하는 플래시 메모리는 **NAND 플래시 메모리**

#### 플래시 메모리 구성
- 셀 (cell) : 플래시 메모리에서 데이터를 저장하는 가장 작은 단위
  - 셀들이 모여 MB, GB, TB 용량을 갖는 저장 장치가 됨
  - 한 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리의 종류가 나뉨
    - SLC (Single Level Cell) 타입 : 한 셀에 1비트 저장
    - MLC (Multiple Level Cell) : 한 셀에 2비트를 저장
    - TLC (Triple Level Cell) : 한 셀에 3비트를 저장  
    - QLC : 한 셀에 4비트 저장
    => 플래시 메모리의 수명, 속도, 가격에 영향을 미침
- 페이지 : 셀들이 모여 만들어진 단위
  - 플래시 메모리에서 **읽기와 쓰기는 페이지 단위**로 이루어짐
- 블록 : 페이지가 모여 만들어진 단위
  - 플래시 메모리에서 **삭제는 블록 단위**로 이루어짐
- 플레인 : 블록이 모여 만들어진 단위
- 다이 : 플레인이 모여 만들어진 단위
![!\[alt text\](image.png)](<플래시메모리 구조.png>)


#### 셀의 타입 
- SLC 타입
  - 한 셀로 두 개의 정보를 표현할 수 있음 (0, 1)
  - 홀로 거주하는 집에 제약없이 출입 가능한 것처럼 MLC나 TLC 타입보다 비트의 빠른 입출력 가능
  - 수명이 MLC나 TLC보다 길다
  - 대신 용량 대비 가격이 높음
    - 마치 혼자서 살면 감당해야 할 주거 비용이 커지는 것과 같음
  - 데이터를 읽고 쓰기가 매우 많이 반복되며 고성능의 빠른 저장 장치가 필요한 경우 사용

- MLC 타입
  - 한 셀로 네개의 정보를 표현할 수 있음
  - SLC 타입보다 일반적으로 속도와 수명은 떨어짐
  - 그러나 한 셀에 두 비트씩 저장할 수 있기 때문에 대용화하기 유리함
  - 집의 개수가 같다면 한 집에서 두명씩 사는게 한명씩 사는 것보다 더 많은 사람을 수용할 수 있는 것과 같은 이치
  - MLC 타입이 SLC 타입보다 용량 대비 가격이 저렴함
  - 시중에 사용되는 많은 플래시 메모리 저장 장치들이 MLC 타입으로 만들어짐

- TLC 타입
  - 한 셀당 3비트씩 저장할 수 있음
  - 한 셀로 8개의 정보를 표현할 수 있어 대용량화 하기 유리
  - SLC, MLC 타입보다 수명과 속도가 떨어지지만 용량 대비 가격이 저렴

- SLC, MLC, TLC 타입 비교
  - 같은 용량의 플래시 메모리 저장 장치라도 셀의 타입에 따라 수명, 가격, 선능이 다름
  - 자주 썼다 지우는 경우, 높은 성능을 원하는 경우에는 고가의 SLC 타입 선택
  - 저가의 대용량 저장 장치를 원한다면 TLC 타입
  - 그 중간을 원하는 경우 MLC 타입의 저장 장치를 선택
  ![!\[alt text\](image.png)](<SLC, MLC, TLC 전체 비교.png>)

#### 플래시 메모리도 수명 존재
- 플래시 메모리, 하드 디스크에도 수명이 있음
- 한 셀에 일정 횟수 이상 데이터를 쓰고 지우면 그 셀은 더 이상 데이터를 저장할 수 없기 때문

#### 플래시 메모리의 동작 방식
- 플래시 메모리에서 `읽기와 쓰기는 페이지 단위` 에서 일어나며 `삭제는 블록 단위`에서 일어남
- 읽기/쓰기 단위와 삭제 단위가 다르다는 것이 플래시 메모리의 가장 큰 특징

<br>

- 페이지는 `Free, Valid, Invalid` 세가지 상태를 가질 수 있음
  1. Free 상태 : 어떠한 데이터도 저장하고 있지 않아 새로운 데이터를 저장할 수 있는 상태
  2. Valid 상태 : 이미 유효한 데이터를 저장하고 있는 상태
  3. Invalid 상태 : 쓰레기 값이라 부르는 유효하지 않은 데이터를 저장하고 있는 상태
   => 플래시 메모리는 하드 디스크와는 달리 덮어쓰기가 불가능하여 Valid 상태인 페이지에는 새 데이터를 저장할 수 없음

<br>

- 플래시 메모리의 간단한 동작 예시
  - 페이지 쓰기
  ![!\[alt text\](image.png)](<페이지 쓰기.png>)
  - 블록 x에서 A를 수정하는 방법
    - 플래시 메모리는 덮어쓰기가 불가능하여 기존에 저장된 A는 Invalid 상태가 되어 더 이상 값이 유효하지 않은 쓰레기 값이 되고 새로운 A 데이터가 저장됨
    - 새로운 A' 데이터가 저장
  ![!\[alt text\](image.png)](<플래시메모리 데이터 수정.png>)
  - 이 경우 A와 같이 Invalid 값을 저장하고 있는 공간은 사용하지 않은 공간인데도 용량을 차지함
    - 하지만 플래시 메모리의 경우 블록 단위로 삭제가 되어 A만 지울 수 없음
    - 이런 값을 정리하기 위해 가비지 컬렉션(garbage collection) 기능을 제공

<br>

- 가비지 컬렉션
  - 유효한 페이지들만을 새로운 블록으로 복사한 뒤 기존의 블록을 삭제하는 기능
  ![- !\[alt text\](image.png)](<가비지 컬렉션.png>)


## 7-2. RAID의 정의와 종류
### RAID의 정의
- 데이터를 안전하게 보관하기 위한 방법 중 하나
- RAID (Redundant Array of Independent Disks) : 주로 하드 디스크와 SSD를 사용하는 기술로 데이터의 안정성 혹은 높은 성능을 위해 여러개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술
![!\[alt text\](image.png)](RAID.png)

### RAID의 종류
- 여러 개의 하드 디시크나 SSD를 마치 하나의 장치처럼 사용하는 RAID를 구성하는 방법은 여러가지가 있음
- RAID 구성 방법을 `RAID 레벨`이라고 표현
- RAID 레벨의 종류
  - RAID0, RAID1, RAID2, RAID3,RAID4, RAID5, RAID6
    - 위의 레벨에서 파생
      - RAID10, RAID50

### RAID 0
- 여러 개의 보조기억장치에 데이터를 단순히 나누어 저장하는 구성 방식
- 1TB 하드 디스크 네 개로 RAID 0을 구성한 경우
  - 데이터를 저장할 때 각 하드 디스크는 아래와 같이 번갈아 가며 데이터를 저장
  - 저장되는 데이터가 하드 디스크 개수만큼 나뉘어 저장되는 것
  ![!\[alt text\](image.png)](<RAID 0.png>)

<br>

- 줄무늬처럼 분산되어 저장된 데이터를 `스트라입 (stripe)`이라고 하고 분산하여 저장하는 것을 `스트라이핑 (striping)`이라고 함
- 분산되어 저장되면(스트라이핑되면) 저장된 데이터를 읽고 쓰는 속도가 빨라짐
  - 대용량 저장 장치를 한 개 썼다면 여러번에 걸쳐 읽고 썼을 데이터를 동시에 읽고 쓸 수 있기 때문
  - 4TB 저장 장치 한개를 읽고 쓰는 것보다 RAID 0으로 구성된 1TB 저장 장치 네 개의 속도가 이론상 네 배 빠름

<br>

- 단점
  - 저장된 정보가 안전하지 않음
  - 구성된 하드 디스크 중 하나에 문제가 생긴다면 모든 하드 디스크의 정보를 읽는데 문제가 생김  
  => 대안으로 생긴 게 RAID 1

### RAID 1
- 거울처럼 복사본을 만드는 방식 : `미러링 (mirroring)`
- 하드 디스크 네 개를 RAID 1로 구성한 경우 RAID 0처럼 데이터 스트라이핑이 되지만 두개의 하드 디스크는 미러링됨
![!\[alt text\](image.png)](<RAID 1.png>)
- RAID 1에 어떠한 데이터를 쓸 때는 원본과 복사본 두 군데에 씀  
  => RAID 0보다 느림

- RAID 1의 장단점
  - 장점
    - 복구가 매우 간단함
  - 단점
    - 하드 디스크 개수가 한정되었을 때 사용 가능한 용량이 적어짐
    - 결국 많은 양의 하드 디스크가 필요하게 되고 비용이 증가함

### RAID 4
- 완전한 복사본을 만드는 대신 오류를 검출하고 복구하기 위한 정보를 저장한 장치를 두는 방식
  - 패리트 비트 : 오류를 검출하고 복구하기 위한 정보
    - 패리트 비트는 오류 검출만 가능하며 오류 복구는 불가
    - 다만 RAID에서는 패리티 값으로 오류 수정 및 복구도 가능
  - 패리트를 저장한 장치를 이용해 다른 장치의 오류를 검출하고 오류가 있으면 복구함
  - 이로 인해 RAID 4는 RAID 1보다 적은 하드 디스크로도 데이터를 안전하게 보관할 수 있음
  ![!\[alt text\](image.png)](<RAID 4.png>)


### RAID 5
- RAID 4에서 어떤 새로운 데이터가 저장될 때마다 패리티를 저장하는 디스크에도 데이터를 쓰게 됨   
  => 패리티를 저장하는 장치에 병목 현상 발생  
  => RAID 5는 아래 그림 처럼 패리티 정보를 분산하여 저장하는 방식으로 이를 해소함
  ![!\[alt text\](image.png)](<RAID 5.png>)

### RAID 6
- 기본적으로 RAID 5와 구성이 같음
- 차이점은 RAID 6는 서로 다른 두개의 패리티를 두는 방식
  ![alt text](<RAID 6.png>)

- 오류를 검출하고 복구할 수 있는 수단이 두개 생김
- RAID 4, RAID 5보다 안전한 구성
- 새로운 정보를 저장할 때마다 함께 저장할 패리티가 두 개이므로 쓰는 속도는 RAID 5보다 느림
  - RAID 6은 데이터 저장 속도를 조금 희생하더라도 데이터를 안전하게 보관하고 싶을 때 사용

---
[목차로 돌아가기](#)


## Q&A
### Q1. 하드디스크의 구성 요소와 저장 방식에 대해 설명해주세요.
A1. 하드 디스크는 자기적인 방식으로 데이터를 저장하는 보조기억 장치이며 플래터, 스핀들, 헤드, 디스크 암으로 구성 되어있습니다. 플래터는 자기 물질로 덮여있는 동그란 원판이며 스핀들은 플래터를 회전시키는 구성 요소입니다. 헤드는 플래터를 대상으로 데이터를 읽고 쓰는 구성 요소이며 디스크 암은 헤드가 부착되어 그 위치를 원하는 곳으로 이동 시켜 줍니다.

하드디스크는 트랙과 섹터라는 단위로 저장됩니다. 트랙은 플래터를 여러 동심원으로 나누었을 때 하나의 원이며 이를 여러 조각으로 나눈 것 중 한 조각을 섹터라고 부릅니다.

하드디스크에서 데이터 접근 과정은 탐색시간, 회전지연, 전송시간을 거칩니다.
접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간을 탐색시간이라고 하며 헤드가 있는 곳으로 플래터를 회전시키는 시간을 회전 지연이라고 합니다. 하드디스크와 컴퓨터 간에 데이터를 전송하는 시간은 전송시간이라고 합니다.

### Q2. 플래시 메모리의 구성 요소와 저장 방식에 대해 설명해주세요.
A2. 플래시는 셀, 페이지, 블록, 플레인, 다이로 이루어져있습니다.
먼저 셀은 플래시 메모리에서 데이터를 저장하는 가장 작은 단위로 한 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리의 종류가 나눠집니다. 그 종류로는 SLC, MLC, TLC, QLC 등이 있습니다.

페이지는 셀들이 모여 만들어진 단위로 읽기와 쓰기가 이루어집니다. 블록은 페이지가 모여 만들어진 단위로 삭제가 이루어집니다.
플레인은 블록이 모여 만들어진 단위이며 다이는 플레인이 모여 만들어진 단위입니다.

페이지에서 Free, Valid, Invalid 상태를 가질 수 있으며 Free 상태인 곳에서 데이터를 저장할 수 있으며 Vaild 상태는 유효한 값을 가지고 있는 상태라 읽을 수 있습니다. Invalid 상태는 유효하지 않은 데이터를 저장하고 있는 상태로 이를 해결하기 위해 가비지 컬렉션을 사용하게 됩니다.

가비지 컬레션이란 유효한 페이지들만을 새로운 블록으로 복사한 뒤 기존의 블록을 삭제하는 기능입니다.

### Q3. RAID의 정의와 대표적인 각 종류에 대해 설명해주세요.
A3. RAID는 데이터를 안전하게 보관하기 위한 방법 중 하나로 하드 디스크와 SSD를 사용하는 기술로 데이터의 안정성 혹은 높은 성능을 위해 여러개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술입니다.

RAID의 레벨 중 대표적인 종류로 RAID 0, RAID 1, RAID 4, RAID 5, RAID 6이 있습니다.

RAID 0은 단순히 여러 개의 보조기억장치에 데이터를 나누어 저장하는 구성 방식으로 훨씬 속도가 빠르지만 구성된 하드 디스크 중 하나 문제가 된다면 모든 정보를 읽는데 문제가 생깁니다.

이를 보완하기 위해 나온 방식이 RAID 1로 미러링을 통해 스트라이핑되어있는 하드 디스크를 동일하게 복사본을 만드는 방식입니다. 이는 복구가 간단하지만 하드 디스크의 개수가 한정되어있을 때 사용 가능한 용량이 적어지고 많은 양의 하드 디스크가 필요해 비용지 증가합니다.

이를 보완하기 위해 나온 방식으로 RAID 4가 있습니다. 이는 완전한 복사본을 만드는 게 아니라 오류를 검출하고 복구하기 위한 정보를 저장한 장치를 두는 방식입니다. 패리트 비트를 통해 오류를 검출하고 복구합니다.

RAID 5는 패리티 정보를 분산하여 저장하여 병목 현상을 방지하며 RAID 6은 서로 다른 패리티를 두개 두어 보다 안전한 구성을 할 수 있습니다.